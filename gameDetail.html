<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Game Forge - 게임 상세</title>
    <link rel="stylesheet" href="store.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&family=Material+Icons&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <header>
      <div class="top-nav">
        <div class="logo">
          <a href="main.html">Game Forge</a> <!-- main 페이지로 이동 -->
        </div>
        <nav>
          <ul class="main-menu">
            <li><a href="store.html">상점</a></li>
            <li><a href="mypage.html">마이페이지</a></li>
            <li><a href="community.html">자유게시판</a></li>
            <li><a href="support.html">지원</a></li>
          </ul>
        </nav>
        <div class="auth-buttons">
          <a href="login.html" class="login-btn">로그인</a>
        </div>
      </div>
      <div class="sub-nav">
        <ul class="submenu">
          <li>내 상점</li>
          <li>최근에 본 제품</li>
          <li>내 태그</li>
          <li>추천 제품</li>
          <li>카테고리 검색</li>
          <li>장르별 검색</li>
        </ul>
      </div>
    </header>
    <div class="container">
      <div class="game-detail">
        <h1 class="game-title">undefined</h1>
        <p class="game-category">카테고리: undefined</p>
        <div class="game-content">
          <img class="game-image" src="https://via.placeholder.com/150" alt="게임 이미지" />
          <div class="game-info">
            <p class="game-price">가격: ₩ undefined</p>
            <button class="cart-btn">장바구니에 담기</button>
          </div>
        </div>
        <div class="game-description">게임 설명 없음</div>
      </div>
    </div>
    <footer>
      <div class="footer-content">
        <p>&copy; 대진대학교 벤처 졸업작품.</p>
      </div>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        // URL에서 gameId 가져오기
        const urlParams = new URLSearchParams(window.location.search);
        const gameId = urlParams.get('gameId');

        if (gameId) {
          try {
            // 서버에서 게임 정보 가져오기
            const response = await fetch(`https://ludorium.store/api/user/game/${gameId}`);
            if (!response.ok) {
              throw new Error('게임 정보를 가져오는 데 실패했습니다.');
            }
            const result = await response.json();

            // 게임 정보를 받아와서 화면에 표시
            const gameData = result.data;

            if (gameData) {
              document.querySelector('.game-title').innerText = gameData.gameName || '제목 없음';
              document.querySelector('.game-category').innerText = `카테고리: ${gameData.categoryName || '미정'}`;
              document.querySelector('.game-image').src = gameData.gameImageUrl || 'https://via.placeholder.com/150';
              document.querySelector('.game-description').innerHTML = gameData.gameDc || '게임 설명 없음';
              document.querySelector('.game-price').innerText = gameData.discountPrice === 0 ? '무료' : `가격: ₩ ${gameData.discountPrice}`;
            } else {
              console.error('게임 데이터를 찾을 수 없습니다.');
            }
          } catch (error) {
            console.error('Error fetching game details:', error);
          }
        } else {
          console.error('게임 ID가 제공되지 않았습니다.');
        }
      });
    </script>
  </body>
</html>
